From 4c3d05d875dd173a81a995c6e14d69496b467eec Mon Sep 17 00:00:00 2001
From: Tom Lane <tgl@sss.pgh.pa.us>
Date: Mon, 15 Jul 2019 23:27:13 -0400
Subject: [PATCH] Remove dead code.

These memory context switches are useless in the wake of commit
1cff1b95a.  Noted by Jesper Pedersen.

Discussion: https://postgr.es/m/f078ce63-9e04-0f3e-d200-d7ee66279abe@redhat.com
---
 src/backend/commands/async.c | 7 -------
 1 file changed, 7 deletions(-)

diff --git a/src/backend/commands/async.c b/src/backend/commands/async.c
index 34e5ca9edb36..6e9c580ec6d0 100644
--- a/src/backend/commands/async.c
+++ b/src/backend/commands/async.c
@@ -693,15 +693,8 @@ pg_listening_channels(PG_FUNCTION_ARGS)
 	/* stuff done only on the first call of the function */
 	if (SRF_IS_FIRSTCALL())
 	{
-		MemoryContext oldcontext;
-
 		/* create a function context for cross-call persistence */
 		funcctx = SRF_FIRSTCALL_INIT();
-
-		/* switch to memory context appropriate for multiple function calls */
-		oldcontext = MemoryContextSwitchTo(funcctx->multi_call_memory_ctx);
-
-		MemoryContextSwitchTo(oldcontext);
 	}
 
 	/* stuff done on every call of the function */
