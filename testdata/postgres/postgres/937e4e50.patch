From 937e4e509998de93d5e1c04d312f1b13ef153210 Mon Sep 17 00:00:00 2001
From: Andres Freund <andres@anarazel.de>
Date: Tue, 20 Nov 2018 20:03:46 -0800
Subject: [PATCH] Fix sepgsql compile error caused by oid removal.

Per buildfarm animal rhinoceros. I (Andres) missed replacing a few
uses of ObjectIdAttributeNumber in sepgsql.

It's quite probable that the sepgsql test output will need more
adapting than done in 578b22...

Author: Thomas Munro
Discussion: https://postgr.es/m/CAEepm=2Sk+66HJV8FLDfm_sKTn22j7cWTY_Y1Rok3RxeWL_Y0w@mail.gmail.com
---
 contrib/sepgsql/database.c | 2 +-
 contrib/sepgsql/proc.c     | 4 ++--
 contrib/sepgsql/relation.c | 4 ++--
 contrib/sepgsql/schema.c   | 2 +-
 4 files changed, 6 insertions(+), 6 deletions(-)

diff --git a/contrib/sepgsql/database.c b/contrib/sepgsql/database.c
index c641ec3565e2..102c9c8012cf 100644
--- a/contrib/sepgsql/database.c
+++ b/contrib/sepgsql/database.c
@@ -80,7 +80,7 @@ sepgsql_database_post_create(Oid databaseId, const char *dtemplate)
 	rel = heap_open(DatabaseRelationId, AccessShareLock);
 
 	ScanKeyInit(&skey,
-				ObjectIdAttributeNumber,
+				Anum_pg_database_oid,
 				BTEqualStrategyNumber, F_OIDEQ,
 				ObjectIdGetDatum(databaseId));
 
diff --git a/contrib/sepgsql/proc.c b/contrib/sepgsql/proc.c
index c6a817d7c58f..a4acfd92daee 100644
--- a/contrib/sepgsql/proc.c
+++ b/contrib/sepgsql/proc.c
@@ -59,7 +59,7 @@ sepgsql_proc_post_create(Oid functionId)
 	rel = heap_open(ProcedureRelationId, AccessShareLock);
 
 	ScanKeyInit(&skey,
-				ObjectIdAttributeNumber,
+				Anum_pg_proc_oid,
 				BTEqualStrategyNumber, F_OIDEQ,
 				ObjectIdGetDatum(functionId));
 
@@ -253,7 +253,7 @@ sepgsql_proc_setattr(Oid functionId)
 	rel = heap_open(ProcedureRelationId, AccessShareLock);
 
 	ScanKeyInit(&skey,
-				ObjectIdAttributeNumber,
+				Anum_pg_proc_oid,
 				BTEqualStrategyNumber, F_OIDEQ,
 				ObjectIdGetDatum(functionId));
 
diff --git a/contrib/sepgsql/relation.c b/contrib/sepgsql/relation.c
index f0c22715aa5f..312740c59836 100644
--- a/contrib/sepgsql/relation.c
+++ b/contrib/sepgsql/relation.c
@@ -262,7 +262,7 @@ sepgsql_relation_post_create(Oid relOid)
 	rel = heap_open(RelationRelationId, AccessShareLock);
 
 	ScanKeyInit(&skey,
-				ObjectIdAttributeNumber,
+				Anum_pg_class_oid,
 				BTEqualStrategyNumber, F_OIDEQ,
 				ObjectIdGetDatum(relOid));
 
@@ -614,7 +614,7 @@ sepgsql_relation_setattr(Oid relOid)
 	rel = heap_open(RelationRelationId, AccessShareLock);
 
 	ScanKeyInit(&skey,
-				ObjectIdAttributeNumber,
+				Anum_pg_class_oid,
 				BTEqualStrategyNumber, F_OIDEQ,
 				ObjectIdGetDatum(relOid));
 
diff --git a/contrib/sepgsql/schema.c b/contrib/sepgsql/schema.c
index bc15a36a459c..7b098318edaf 100644
--- a/contrib/sepgsql/schema.c
+++ b/contrib/sepgsql/schema.c
@@ -59,7 +59,7 @@ sepgsql_schema_post_create(Oid namespaceId)
 	rel = heap_open(NamespaceRelationId, AccessShareLock);
 
 	ScanKeyInit(&skey,
-				ObjectIdAttributeNumber,
+				Anum_pg_namespace_oid,
 				BTEqualStrategyNumber, F_OIDEQ,
 				ObjectIdGetDatum(namespaceId));
 
